# RAGEnhancedAgentMemory

<div align="center">

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python](https://img.shields.io/badge/Python-3.9%2B-blue.svg)](https://www.python.org/)
[![Test Coverage](https://img.shields.io/badge/Test%20Coverage-80%2B%25-brightgreen)](tests/)
[![Status](https://img.shields.io/badge/Status-Production%20Ready-success)](docs/PROJECT_STATUS.md)

**RAG å¢å¼ºå‹ Agent è®°å¿†ç³»ç»Ÿ**  
*åŸºäº LangGraph ä¸ vLLM çš„é«˜æ€§èƒ½æ¶æ„*

[ç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [æ–‡æ¡£](#-æ–‡æ¡£) â€¢ [æ€§èƒ½](#-æ€§èƒ½æŒ‡æ ‡) â€¢ [è´¡çŒ®](#-è´¡çŒ®æŒ‡å—)

</div>

---

## ğŸ“‘ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
- [æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
- [æ€§èƒ½æŒ‡æ ‡](#-æ€§èƒ½æŒ‡æ ‡)
- [æ¶æ„è®¾è®¡](#-æ¶æ„è®¾è®¡)
- [å®‰è£…æŒ‡å—](#-å®‰è£…æŒ‡å—)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#-é…ç½®è¯´æ˜)
- [ä½¿ç”¨ç¤ºä¾‹](#-ä½¿ç”¨ç¤ºä¾‹)
- [æ–‡æ¡£](#-æ–‡æ¡£)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)
- [è®¸å¯è¯](#-è®¸å¯è¯)

---

## ğŸ¯ é¡¹ç›®ç®€ä»‹

**RAGEnhancedAgentMemory** æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ AI Agent è®°å¿†å¢å¼ºç³»ç»Ÿï¼Œæ—¨åœ¨è§£å†³é•¿å¯¹è¯åœºæ™¯ä¸­çš„ä¸‰å¤§æ ¸å¿ƒæŒ‘æˆ˜ï¼š

| æŒ‘æˆ˜ | ä¼ ç»Ÿæ–¹æ¡ˆ | æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ |
|------|---------|--------------|
| **è®°å¿†è¿‡è½½** | æ»‘åŠ¨çª—å£å¯¼è‡´æ—©æœŸå…³é”®ä¿¡æ¯ä¸¢å¤± | âœ… åˆ†å±‚è®°å¿†æ¶æ„ |
| **ä¿¡æ¯é—å¿˜** | å…¨é‡æ‘˜è¦è€—å°½ä¸Šä¸‹æ–‡çª—å£ | âœ… å‘é‡æ•°æ®åº“è¯­ä¹‰æ£€ç´¢ |
| **æ¨ç†é€€åŒ–** | æµ·é‡å†å²æ•°æ®çº¿æ€§æŸ¥æ‰¾æ•ˆç‡ä½ | âœ… vLLM åŠ é€Ÿæ¨ç†ï¼Œå»¶è¿Ÿé™ä½ 44.56% |

### æ ¸å¿ƒæˆå°±

- âœ… **é•¿å¯¹è¯æˆåŠŸç‡æå‡ 66.67%-100%**ï¼ˆè¶…é¢å®Œæˆ 2-3 å€ï¼‰
- âœ… **å­˜å‚¨æ•ˆç‡ä¼˜åŒ– 57.14%-100%**ï¼ˆè¶…è¿‡ 45% ç›®æ ‡ï¼‰
- âœ… **æ¨ç†å»¶è¿Ÿé™ä½ 44.56%**ï¼ˆè¶…é¢å®Œæˆ 1.78 å€ï¼Œç›®æ ‡ 25%+ï¼‰
- âœ… **å¹¶å‘ååé‡æå‡ 1216%**ï¼ˆ20 è·¯å¹¶å‘ï¼‰

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### æ ¸å¿ƒèƒ½åŠ›

- **ğŸ§  åˆ†å±‚è®°å¿†ç³»ç»Ÿ**
  - ç¬æ—¶è®°å¿†ï¼ˆLangGraph Stateï¼‰
  - çŸ­æœŸè®°å¿†ï¼ˆæ»‘åŠ¨çª—å£ + å®ä½“ç¼“å­˜ï¼‰
  - é•¿æœŸè¯­ä¹‰è®°å¿†ï¼ˆå‘é‡æ•°æ®åº“ï¼‰

- **ğŸ”„ è‡ªé€‚åº”æ£€ç´¢è·¯ç”±**
  - æ™ºèƒ½å†³ç­–ä½•æ—¶ä»é•¿æœŸè®°å¿†æ£€ç´¢
  - è‡ªåŠ¨å›é€€åˆ°çŸ­æœŸç¼“å­˜

- **ğŸ” æ··åˆæ£€ç´¢**
  - å‘é‡æœç´¢ï¼ˆè¯­ä¹‰ç›¸ä¼¼åº¦ï¼‰
  - å…³é”®è¯æœç´¢ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
  - ä½¿ç”¨ BAAI/bge-reranker-large é‡æ’åº

- **âš¡ é«˜æ€§èƒ½æ¨ç†**
  - vLLM PagedAttention åŠ¨æ€ KV cache ç®¡ç†
  - Prefix Caching ç›¸ä¼¼æç¤ºå¤ç”¨ï¼ˆå¯é€‰ï¼‰
  - é»˜è®¤ç¦ç”¨ CUDA Graphï¼ˆé¿å… duplicate template name é”™è¯¯ï¼Œä¿è¯ç¨³å®šæ€§ï¼‰

- **ğŸ“Š è´¨é‡ä¿éšœ**
  - é›†æˆ Ragas è¯„ä¼°æ¡†æ¶
  - Needle-in-a-Haystack æµ‹è¯•
  - 80%+ æµ‹è¯•è¦†ç›–ç‡ï¼ˆæ ¸å¿ƒæ¨¡å— 93%+ï¼‰

- **ğŸ’¾ çŠ¶æ€æŒä¹…åŒ–**
  - LangGraph Checkpointing ä¼šè¯çŠ¶æ€ç®¡ç†
  - PostgreSQL é›†æˆä¿è¯ ACID ä¸€è‡´æ€§

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### æ¨¡æ‹Ÿæµ‹è¯•ç»“æœ

æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„ Agent æ¥æ¨¡æ‹Ÿç”¨æˆ·ä½¿ç”¨æœ¬æ’ä»¶ä¼˜åŒ–è‡ªå·±çš„ Agentï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éªŒè¯åŠŸèƒ½æ•ˆæœã€‚æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š

#### æ¨¡æ‹Ÿæµ‹è¯•åœºæ™¯

- **æµ‹è¯• Agent**ï¼šç®€å•çš„å¯¹è¯ Agentï¼ˆæ¨¡æ‹Ÿç”¨æˆ·å·²æœ‰çš„ Agentï¼‰
- **ä¼˜åŒ–æ–¹å¼**ï¼šä½¿ç”¨ RAGEnhancedAgentMemory æ’ä»¶è¿›è¡Œä¼˜åŒ–
- **æµ‹è¯•è½®æ•°**ï¼š91 è½®å¯¹è¯
- **æµ‹è¯•å†…å®¹**ï¼šäººè®¾è®¾å®šã€é‡å¤æŸ¥è¯¢ã€ä½ä»·å€¼ä¿¡æ¯è¿‡æ»¤ã€é•¿æœŸè®°å¿†å¬å›
- **éƒ¨ç½²æ¨¡å¼**ï¼šäº‘ç«¯ APIï¼ˆDeepSeekï¼‰å’Œæœ¬åœ°æ¨¡å‹ï¼ˆvLLMï¼‰

#### æ ¸å¿ƒéªŒè¯ç»“æœ

| éªŒè¯é¡¹ | ç»“æœ | è¯´æ˜ |
|--------|------|------|
| **æ’ä»¶æ˜“ç”¨æ€§** | âœ… é€šè¿‡ | æˆ‘ä»¬å¯ä»¥è½»æ¾å°†æ’ä»¶é›†æˆåˆ°è‡ªå·±çš„ Agent ä¸­è¿›è¡Œä¼˜åŒ–ï¼ˆæ¨¡æ‹Ÿç”¨æˆ·åœºæ™¯ï¼‰ |
| **é•¿æœŸè®°å¿†å¬å›** | âœ… 100.0% | ä¸¤ç§éƒ¨ç½²æ¨¡å¼ä¸‹éƒ½è¾¾åˆ° 100% å¬å›ç‡ |
| **å­˜å‚¨ä¼˜åŒ–** | âœ… 60.4%-73.6% | å™ªéŸ³è¿‡æ»¤ç‡æ˜¾è‘—ï¼Œæœ‰æ•ˆå‡å°‘å­˜å‚¨å†—ä½™ |
| **ä¿¡æ¯ä¿ç•™** | âœ… 100.0% | å…³é”®ä¿¡æ¯å¾—åˆ°æœ‰æ•ˆä¿ç•™ |
| **æ¨ç†æ€§èƒ½** | âœ… æå‡ 80.2% | æœ¬åœ° vLLM æ¨¡å¼ä¸‹ååé‡æå‡ 80.2% |

> ğŸ“‹ **è¯¦ç»†æµ‹è¯•æŠ¥å‘Š**ï¼šå‚è§ [æ¨¡æ‹Ÿæµ‹è¯•æŠ¥å‘Š](docs/EXPERIMENT_SUMMARY.md)ï¼ˆæˆ‘ä»¬æ¨¡æ‹Ÿç”¨æˆ·ä½¿ç”¨æ’ä»¶çš„æµ‹è¯•ç»“æœï¼‰

### åŸºå‡†æµ‹è¯•ç»“æœ

#### é•¿å¯¹è¯æˆåŠŸç‡

| å¯¹è¯è½®æ•° | åŸºçº¿ç³»ç»Ÿ | å¢å¼ºç³»ç»Ÿ | æå‡å¹…åº¦ | çŠ¶æ€ |
|---------|---------|---------|---------|------|
| 10 è½® | 100% | 100% | 0% | åŸºçº¿ç³»ç»Ÿå¯å¤„ç† |
| 30 è½® | 0% | **66.67%** | **+66.67 ç™¾åˆ†ç‚¹** | âœ… è¶…é¢å®Œæˆ |
| 50 è½® | 0% | **66.67%** | **+66.67 ç™¾åˆ†ç‚¹** | âœ… è¶…é¢å®Œæˆ |
| 100 è½® | 0% | **100%** | **+100 ç™¾åˆ†ç‚¹** | âœ… è¶…é¢å®Œæˆ |

#### å­˜å‚¨æ•ˆç‡ä¼˜åŒ–

| æµ‹è¯•åœºæ™¯ | åŸºçº¿å­˜å‚¨ | ä¼˜åŒ–å­˜å‚¨ | é™ä½ç‡ | çŠ¶æ€ |
|---------|---------|---------|--------|------|
| çœŸå®ä¸šåŠ¡åœºæ™¯ | 21 æ¡ | **9 æ¡** | **57.14%** | âœ… è¶…è¿‡ç›®æ ‡ |
| å‹åŠ›æµ‹è¯• | 3 æ¡ | **0 æ¡** | **100%** | âœ… å®Œç¾å»é‡ |
| ç”Ÿäº§ç¯å¢ƒæ¨¡æ‹Ÿ | 12 æ¡ | **1 æ¡** | **91.67%** | âœ… é«˜åº¦èšåˆ |

#### æ¨ç†å»¶è¿Ÿä¼˜åŒ–

| æŒ‡æ ‡ | åŸºçº¿ (Transformers) | vLLM (ä¼˜åŒ–) | æå‡å¹…åº¦ | çŠ¶æ€ |
|------|-------------------|-----------|---------|------|
| **é¦–å­—å»¶è¿Ÿ (TTFT)** | 380.5 ms | **210.9 ms** | **-44.56%** | âœ… è¶…é¢å®Œæˆ |
| **ç«¯åˆ°ç«¯å»¶è¿Ÿ** | 3805.4 ms | **2109.6 ms** | **-44.56%** | âœ… è¶…é¢å®Œæˆ |
| **å•è¯·æ±‚ååé‡** | 67.3 tokens/s | **101.2 tokens/s** | **+50.44%** | âœ… |
| **å¹¶å‘ååé‡ (20è·¯)** | 70.3 tokens/s | **925.7 tokens/s** | **+1216%** | âœ… |

> ğŸ“ˆ **è¯¦ç»†æ€§èƒ½æŠ¥å‘Š**ï¼šå¼€å‘/æµ‹è¯•æ–‡æ¡£å·²ç§»è‡³ `dev/` ç›®å½•ï¼Œä»…ä¾›å¼€å‘è€…ä½¿ç”¨ã€‚

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç¼–æ’å±‚ (Orchestration)                  â”‚
â”‚                   LangGraph - çŠ¶æ€æœºç®¡ç†                  â”‚
â”‚             æ”¯æŒå¾ªç¯ã€åˆ†æ”¯ã€è‡ªæˆ‘ä¿®æ­£ã€çŠ¶æ€æŒä¹…åŒ–            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              è®°å¿†ç®¡ç†å±‚ (Memory Management)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç¬æ—¶è®°å¿†    â”‚  â”‚  çŸ­æœŸè®°å¿†    â”‚  â”‚  é•¿æœŸè®°å¿†    â”‚  â”‚
â”‚  â”‚  (State)     â”‚â†’ â”‚  (Buffer)    â”‚â†’ â”‚  (Vector DB) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ£€ç´¢å¢å¼ºå±‚ (RAG & Retrieval)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å‘é‡æ£€ç´¢    â”‚  â”‚  æ··åˆæ£€ç´¢    â”‚  â”‚  é‡æ’åº      â”‚  â”‚
â”‚  â”‚  (Qdrant)    â”‚  â”‚  (Hybrid)    â”‚  â”‚  (Rerank)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æ¨ç†å±‚ (Inference)                        â”‚
â”‚              vLLM - PagedAttention                       â”‚
â”‚         Prefix Caching + KV Cache ä¼˜åŒ–                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | é€‰å‹ç†ç”± |
|------|---------|---------|
| **ç¼–æ’æ¡†æ¶** | LangGraph | æ”¯æŒå¾ªç¯ã€çŠ¶æ€æŒä¹…åŒ–å’ŒçŸ­è·¯æ§åˆ¶ |
| **æ¨ç†å¼•æ“** | vLLM | PagedAttention æå‡ååé‡ï¼ŒPrefix Caching é™ä½é¦–å­—å»¶è¿Ÿ |
| **å‘é‡æ•°æ®åº“** | Qdrant / Chroma | é«˜æ€§èƒ½è¿‡æ»¤ï¼ŒRust å®ç°ï¼ˆQdrantï¼‰æ€§èƒ½ä¼˜å¼‚ |
| **æ£€ç´¢ç­–ç•¥** | Hybrid + Rerank | å‘é‡æœç´¢ + å…³é”®è¯åŒ¹é… + é‡æ’åº |
| **è¯„ä¼°æ¡†æ¶** | Ragas | LLM-as-a-Judge å¯æ‰©å±•è¯„ä¼°æ–¹æ³• |
| **æŒä¹…åŒ–** | PostgreSQL + Vector | ACID ä¸€è‡´æ€§ + è¯­ä¹‰æ£€ç´¢ |

---

## ğŸ“¦ å®‰è£…æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- Python >= 3.9
- CUDA >= 11.8ï¼ˆå¦‚éœ€ä½¿ç”¨ vLLMï¼‰
- 8GB+ RAMï¼ˆæ¨è 16GB+ï¼‰

### æ–¹å¼ä¸€ï¼šä» GitHub å®‰è£…ï¼ˆæ¨èï¼‰

```bash
# å®‰è£…æœ€æ–°ç‰ˆæœ¬
pip install git+https://github.com/F0rJay/RAGEnhancedAgentMemory.git

# å®‰è£…ç‰¹å®šç‰ˆæœ¬
pip install git+https://github.com/F0rJay/RAGEnhancedAgentMemory.git@v0.1.0

# å®‰è£…æ—¶åŒ…å« vLLM æ”¯æŒï¼ˆå¯é€‰ï¼‰
pip install "rag-enhanced-agent-memory[vllm]"

# å®‰è£…å¼€å‘ä¾èµ–ï¼ˆå¯é€‰ï¼‰
pip install "rag-enhanced-agent-memory[dev]"
```

### æ–¹å¼äºŒï¼šä»æºç å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/F0rJay/RAGEnhancedAgentMemory.git
cd RAGEnhancedAgentMemory

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# ä»¥å¯ç¼–è¾‘æ¨¡å¼å®‰è£…
pip install -e .

# é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å¿…è¦çš„é…ç½®
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä½¿ç”¨

```python
from rag_enhanced_agent_memory import RAGEnhancedAgentMemory

# åˆå§‹åŒ–è®°å¿†ç³»ç»Ÿ
memory = RAGEnhancedAgentMemory(
    vector_db="qdrant",  # æˆ– "chroma"
    embedding_model="BAAI/bge-large-en-v1.5",
    rerank_model="BAAI/bge-reranker-large",
    session_id="my_session"
)

# æ·»åŠ è®°å¿†
memory_id = memory.add_memory(
    content="ç”¨æˆ·å–œæ¬¢ä½¿ç”¨ Python ç¼–ç¨‹",
    metadata={"category": "preference", "topic": "programming"}
)

# æœç´¢è®°å¿†
results = memory.search("ç”¨æˆ·çš„æŠ€æœ¯åå¥½", top_k=5)
for result in results:
    print(f"å†…å®¹: {result['content']}")
    print(f"è¯„åˆ†: {result['score']:.2f}")

# ä¿å­˜å¯¹è¯ä¸Šä¸‹æ–‡
memory.save_context(
    inputs={"input": "ç”¨æˆ·é—®é¢˜"},
    outputs={"generation": "AI å›ç­”"}
)
```

### LangGraph é›†æˆ

```python
from rag_enhanced_agent_memory import RAGEnhancedAgentMemory
from rag_enhanced_agent_memory.graph.state import AgentState
from langgraph.graph import StateGraph

# åˆå§‹åŒ–è®°å¿†ç³»ç»Ÿ
memory = RAGEnhancedAgentMemory(vector_db="qdrant")

# å®šä¹‰ç”ŸæˆèŠ‚ç‚¹
def generate_node(state: AgentState) -> AgentState:
    # ä½¿ç”¨æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ç”Ÿæˆå›ç­”
    context = "\n".join(state.get("documents", []))
    state["generation"] = generate_response(context, state["input"])
    return state

# æ„å»ºå›¾
graph = StateGraph(AgentState)
graph.add_node("retrieve", memory.retrieve_context)
graph.add_node("generate", generate_node)
graph.add_node("save", memory.save_context)

# è®¾ç½®è¾¹
graph.set_entry_point("retrieve")
graph.add_edge("retrieve", "generate")
graph.add_edge("generate", "save")

# ç¼–è¯‘å¹¶è¿è¡Œ
app = graph.compile(checkpointer=memory.get_checkpointer())
config = {"configurable": {"thread_id": memory.session_id}}
result = app.invoke(
    {"input": "ç”¨æˆ·çš„æŠ€æœ¯æ ˆæ˜¯ä»€ä¹ˆï¼Ÿ", "chat_history": []},
    config=config
)
```

> ğŸ“š **æ›´å¤šç¤ºä¾‹**ï¼šå‚è§ [QUICKSTART.md](QUICKSTART.md) å’Œ [docs/PLUGIN_USAGE.md](docs/PLUGIN_USAGE.md)

---

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

ä» `env.example` åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# å‘é‡æ•°æ®åº“
VECTOR_DB=qdrant
QDRANT_URL=http://localhost:6333

# æ¨¡å‹é…ç½®
EMBEDDING_MODEL=BAAI/bge-large-en-v1.5
RERANK_MODEL=BAAI/bge-reranker-large

# è®°å¿†ç³»ç»Ÿå‚æ•°
SHORT_TERM_THRESHOLD=10
LONG_TERM_TRIGGER=0.7
```

### ä»£ç é…ç½®

```python
memory = RAGEnhancedAgentMemory(
    vector_db="qdrant",
    embedding_model="BAAI/bge-large-en-v1.5",
    rerank_model="BAAI/bge-reranker-large",
    short_term_threshold=10,      # çŸ­æœŸè®°å¿†æœ€å¤§è½®æ•°
    long_term_trigger=0.7,        # é•¿æœŸè®°å¿†è§¦å‘é˜ˆå€¼
    use_hybrid_retrieval=True,     # å¯ç”¨æ··åˆæ£€ç´¢
    use_rerank=True,               # å¯ç”¨é‡æ’åº
    checkpoint_dir="./checkpoints", # æ£€æŸ¥ç‚¹ç›®å½•
    session_id="custom_session"     # ä¼šè¯ ID
)
```

> ğŸ“– **è¯¦ç»†é…ç½®è¯´æ˜**ï¼šå‚è§ [docs/ENV_CONFIG.md](docs/ENV_CONFIG.md)

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹è„šæœ¬

```bash
# åŸºç¡€ä½¿ç”¨ç¤ºä¾‹
python scripts/basic_example.py

# LangGraph é›†æˆç¤ºä¾‹
python scripts/langgraph_example.py

# è¯„ä¼°ç¤ºä¾‹
python scripts/evaluation_example.py

# æ³¨æ„ï¼šåŸºå‡†æµ‹è¯•è„šæœ¬å·²ç§»è‡³å†…éƒ¨å¼€å‘å·¥å…·ï¼Œä¸å¯¹å¤–æä¾›
# å¦‚éœ€äº†è§£æµ‹è¯•ç»“æœï¼Œè¯·æŸ¥çœ‹ docs/EXPERIMENT_SUMMARY.md
```

### é¡¹ç›®ç»“æ„

```
RAGEnhancedAgentMemory/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core.py                # æ ¸å¿ƒç³»ç»Ÿé›†æˆ
â”‚   â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ memory/                # è®°å¿†ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ retrieval/             # æ£€ç´¢æ¨¡å—
â”‚   â”œâ”€â”€ inference/             # æ¨ç†å¼•æ“
â”‚   â”œâ”€â”€ graph/                 # LangGraph é›†æˆ
â”‚   â””â”€â”€ evaluation/            # è¯„ä¼°æ¡†æ¶
â”œâ”€â”€ tests/                     # æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ scripts/                   # ç”¨æˆ·ç¤ºä¾‹è„šæœ¬å’Œå·¥å…·
â”œâ”€â”€ dev/                       # å¼€å‘/æµ‹è¯•æ–‡ä»¶ï¼ˆä¸å¯¹å¤–æä¾›ï¼‰
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”œâ”€â”€ requirements.txt           # ä¾èµ–åˆ—è¡¨
â””â”€â”€ pyproject.toml            # åŒ…é…ç½®
```

---

## ğŸ“š æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£ï¼ˆç”¨æˆ·æ–‡æ¡£ï¼‰

- ğŸš€ [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICKSTART.md) - 5 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
- ğŸ”Œ [æ’ä»¶ä½¿ç”¨æŒ‡å—](docs/PLUGIN_USAGE.md) - å¼€å‘è€…é›†æˆæŒ‡å—
- ğŸ“– [ä½¿ç”¨æ–‡æ¡£](docs/USAGE.md) - è¯¦ç»†ä½¿ç”¨è¯´æ˜
- âš™ï¸ [ç¯å¢ƒé…ç½®](docs/ENV_CONFIG.md) - ç¯å¢ƒå˜é‡é…ç½®è¯´æ˜
- ğŸ–¥ï¸ [vLLM æœåŠ¡å™¨è®¾ç½®](docs/VLLM_SERVER_SETUP.md) - vLLM æœåŠ¡é…ç½®æŒ‡å—
- ğŸ“Š [æ¨¡æ‹Ÿæµ‹è¯•æŠ¥å‘Š](docs/EXPERIMENT_SUMMARY.md) - æˆ‘ä»¬æ¨¡æ‹Ÿç”¨æˆ·ä½¿ç”¨æ’ä»¶çš„æµ‹è¯•ç»“æœ

> **æ³¨æ„**ï¼šå…¶ä»–å¼€å‘/æµ‹è¯•æ–‡æ¡£ï¼ˆæ€§èƒ½æŠ¥å‘Šã€é¡¹ç›®çŠ¶æ€ç­‰ï¼‰å·²ç§»è‡³ `dev/` ç›®å½•ï¼Œä»…ä¾›å¼€å‘è€…ä½¿ç”¨ã€‚

### è®¾ç½®æŒ‡å—

- ğŸ”§ [ç¯å¢ƒå˜é‡é…ç½®](docs/ENV_CONFIG.md) - ç¯å¢ƒå˜é‡å‚è€ƒ
- ğŸ³ [Docker è®¾ç½®](docs/DOCKER_SETUP.md) - Docker éƒ¨ç½²æŒ‡å—
- ğŸ—„ï¸ [PostgreSQL è®¾ç½®](docs/POSTGRESQL_SETUP.md) - æ•°æ®åº“è®¾ç½®æŒ‡å—

---

## ğŸ§ª æµ‹è¯•ä¸è¯„ä¼°

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œå¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=src --cov-report=html --cov-report=term

# è¿è¡Œç‰¹å®šæµ‹è¯•å¥—ä»¶
pytest tests/test_core.py
```

### è¯„ä¼°æ¡†æ¶

æˆ‘ä»¬ä½¿ç”¨ **Ragas** è¿›è¡Œç»¼åˆè¯„ä¼°ï¼š

- **Context Recall**ï¼šæ£€ç´¢åˆ°çš„å†…å®¹æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…è¦ä¿¡æ¯ï¼Ÿ
- **Context Precision**ï¼šé«˜è´¨é‡ç»“æœæ˜¯å¦æ’åœ¨å‰é¢ï¼Ÿ
- **Faithfulness**ï¼šç­”æ¡ˆæ˜¯å¦å®Œå…¨åŸºäºæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ï¼Ÿ
- **Answer Relevancy**ï¼šç­”æ¡ˆæ˜¯å¦ä¸é—®é¢˜ç›¸å…³ï¼Ÿ

### Needle-in-a-Haystack æµ‹è¯•

éªŒè¯é•¿ä¸Šä¸‹æ–‡ä¸­çš„æ£€ç´¢èƒ½åŠ›ï¼š
- åœ¨ 20k token çš„æ–‡æœ¬ä¸­æ’å…¥å…³é”®äº‹å®
- æµ‹è¯• 0%ã€50%ã€100% ä½ç½®
- éªŒè¯æ‰€æœ‰ä½ç½® 100% å‡†ç¡®ç‡

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. **Fork** æœ¬ä»“åº“
2. **åˆ›å»º** ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. **æäº¤** æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. **æ¨é€** åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. **å¼€å¯** Pull Request

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install "rag-enhanced-agent-memory[dev]"

# è¿è¡Œæµ‹è¯•
pytest

# æ ¼å¼åŒ–ä»£ç 
black src/ tests/

# ä»£ç æ£€æŸ¥
ruff check src/ tests/
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹ä¼˜ç§€å¼€æºé¡¹ç›®æ„å»ºï¼š

- [LangGraph](https://github.com/langchain-ai/langgraph) - Agent ç¼–æ’æ¡†æ¶
- [vLLM](https://github.com/vllm-project/vllm) - é«˜æ€§èƒ½ LLM æ¨ç†å¼•æ“
- [Qdrant](https://github.com/qdrant/qdrant) - å‘é‡æ•°æ®åº“
- [Ragas](https://github.com/explodinggradients/ragas) - RAG è¯„ä¼°æ¡†æ¶

---

## ğŸ”— ç›¸å…³èµ„æº

- [LangGraph å®˜æ–¹æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [vLLM æ–‡æ¡£](https://docs.vllm.ai/)
- [RAG æœ€ä½³å®è·µ](https://github.com/langchain-ai/langgraph/discussions)

---

## ğŸ“§ è”ç³»æ–¹å¼

- ğŸ“ [æäº¤ Issue](https://github.com/F0rJay/RAGEnhancedAgentMemory/issues) - æŠ¥å‘Šé—®é¢˜æˆ–è¯·æ±‚åŠŸèƒ½
- ğŸ’¬ [è®¨è®ºåŒº](https://github.com/F0rJay/RAGEnhancedAgentMemory/discussions) - æé—®å’Œåˆ†äº«æƒ³æ³•

---

<div align="center">

**ç”± [F0rJay](https://github.com/F0rJay) ç”¨ â¤ï¸ åˆ¶ä½œ**

[â­ åœ¨ GitHub ä¸Š Star æˆ‘ä»¬](https://github.com/F0rJay/RAGEnhancedAgentMemory) â€¢ [ğŸ“– é˜…è¯»æ–‡æ¡£](docs/) â€¢ [ğŸ› æŠ¥å‘Š Bug](https://github.com/F0rJay/RAGEnhancedAgentMemory/issues)

</div>
